// auto generated by kmigrator
// KMIGRATOR:0004_auto_20210217_0611:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMS42IG9uIDIwMjEtMDItMTcgMDY6MTEKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKaW1wb3J0IGRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24KCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAwMDNfYXV0b18yMDIxMDIxM18xODQzJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkNyZWF0ZU1vZGVsKAogICAgICAgICAgICBuYW1lPSdhcHBsaWNhdGlvbl9hc3NpZ25lZXNfbWFueScsCiAgICAgICAgICAgIGZpZWxkcz1bCiAgICAgICAgICAgICAgICAoJ2lkJywgbW9kZWxzLkF1dG9GaWVsZChhdXRvX2NyZWF0ZWQ9VHJ1ZSwgcHJpbWFyeV9rZXk9VHJ1ZSwgc2VyaWFsaXplPUZhbHNlLCB2ZXJib3NlX25hbWU9J0lEJykpLAogICAgICAgICAgICBdLAogICAgICAgICAgICBvcHRpb25zPXsKICAgICAgICAgICAgICAgICdkYl90YWJsZSc6ICdBcHBsaWNhdGlvbl9hc3NpZ25lZXNfbWFueScsCiAgICAgICAgICAgIH0sCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkNyZWF0ZU1vZGVsKAogICAgICAgICAgICBuYW1lPSdhcHBsaWNhdGlvbl9leGVjdXRvcnNfbWFueScsCiAgICAgICAgICAgIGZpZWxkcz1bCiAgICAgICAgICAgICAgICAoJ2lkJywgbW9kZWxzLkF1dG9GaWVsZChhdXRvX2NyZWF0ZWQ9VHJ1ZSwgcHJpbWFyeV9rZXk9VHJ1ZSwgc2VyaWFsaXplPUZhbHNlLCB2ZXJib3NlX25hbWU9J0lEJykpLAogICAgICAgICAgICBdLAogICAgICAgICAgICBvcHRpb25zPXsKICAgICAgICAgICAgICAgICdkYl90YWJsZSc6ICdBcHBsaWNhdGlvbl9leGVjdXRvcnNfbWFueScsCiAgICAgICAgICAgIH0sCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbmFtZU1vZGVsKAogICAgICAgICAgICBvbGRfbmFtZT0ndGlja2V0JywKICAgICAgICAgICAgbmV3X25hbWU9J2FwcGxpY2F0aW9uJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuUmVuYW1lTW9kZWwoCiAgICAgICAgICAgIG9sZF9uYW1lPSd0aWNrZXRjbGFzc2lmaWVyJywKICAgICAgICAgICAgbmV3X25hbWU9J2FwcGxpY2F0aW9uY2xhc3NpZmllcicsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbmFtZU1vZGVsKAogICAgICAgICAgICBvbGRfbmFtZT0ndGlja2V0Y2xhc3NpZmllcmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuZXdfbmFtZT0nYXBwbGljYXRpb25jbGFzc2lmaWVyaGlzdG9yeXJlY29yZCcsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbmFtZU1vZGVsKAogICAgICAgICAgICBvbGRfbmFtZT0ndGlja2V0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5ld19uYW1lPSdhcHBsaWNhdGlvbmhpc3RvcnlyZWNvcmQnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW5hbWVNb2RlbCgKICAgICAgICAgICAgb2xkX25hbWU9J3RpY2tldHNvdXJjZScsCiAgICAgICAgICAgIG5ld19uYW1lPSdhcHBsaWNhdGlvbnNvdXJjZScsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbmFtZU1vZGVsKAogICAgICAgICAgICBvbGRfbmFtZT0ndGlja2V0c291cmNlaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5ld19uYW1lPSdhcHBsaWNhdGlvbnNvdXJjZWhpc3RvcnlyZWNvcmQnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW5hbWVNb2RlbCgKICAgICAgICAgICAgb2xkX25hbWU9J3RpY2tldHN0YXR1cycsCiAgICAgICAgICAgIG5ld19uYW1lPSdhcHBsaWNhdGlvbnN0YXR1cycsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbmFtZU1vZGVsKAogICAgICAgICAgICBvbGRfbmFtZT0ndGlja2V0c3RhdHVzaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5ld19uYW1lPSdhcHBsaWNhdGlvbnN0YXR1c2hpc3RvcnlyZWNvcmQnLAogICAgICAgICksCiMgICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiMgICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRfZXhlY3V0b3JzX21hbnknLAojICAgICAgICAgICAgbmFtZT0nVGlja2V0X2xlZnRfaWQnLAojICAgICAgICApLAojICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAojICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0X2V4ZWN1dG9yc19tYW55JywKIyAgICAgICAgICAgIG5hbWU9J1VzZXJfcmlnaHRfaWQnLAojICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJNb2RlbFRhYmxlKAogICAgICAgICAgICBuYW1lPSdhcHBsaWNhdGlvbicsCiAgICAgICAgICAgIHRhYmxlPSdBcHBsaWNhdGlvbicsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyTW9kZWxUYWJsZSgKICAgICAgICAgICAgbmFtZT0nYXBwbGljYXRpb25jbGFzc2lmaWVyJywKICAgICAgICAgICAgdGFibGU9J0FwcGxpY2F0aW9uQ2xhc3NpZmllcicsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyTW9kZWxUYWJsZSgKICAgICAgICAgICAgbmFtZT0nYXBwbGljYXRpb25jbGFzc2lmaWVyaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIHRhYmxlPSdBcHBsaWNhdGlvbkNsYXNzaWZpZXJIaXN0b3J5UmVjb3JkJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJNb2RlbFRhYmxlKAogICAgICAgICAgICBuYW1lPSdhcHBsaWNhdGlvbmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICB0YWJsZT0nQXBwbGljYXRpb25IaXN0b3J5UmVjb3JkJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJNb2RlbFRhYmxlKAogICAgICAgICAgICBuYW1lPSdhcHBsaWNhdGlvbnNvdXJjZScsCiAgICAgICAgICAgIHRhYmxlPSdBcHBsaWNhdGlvblNvdXJjZScsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyTW9kZWxUYWJsZSgKICAgICAgICAgICAgbmFtZT0nYXBwbGljYXRpb25zb3VyY2VoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgdGFibGU9J0FwcGxpY2F0aW9uU291cmNlSGlzdG9yeVJlY29yZCcsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyTW9kZWxUYWJsZSgKICAgICAgICAgICAgbmFtZT0nYXBwbGljYXRpb25zdGF0dXMnLAogICAgICAgICAgICB0YWJsZT0nQXBwbGljYXRpb25TdGF0dXMnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlck1vZGVsVGFibGUoCiAgICAgICAgICAgIG5hbWU9J2FwcGxpY2F0aW9uc3RhdHVzaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIHRhYmxlPSdBcHBsaWNhdGlvblN0YXR1c0hpc3RvcnlSZWNvcmQnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYXBwbGljYXRpb25fZXhlY3V0b3JzX21hbnknLAogICAgICAgICAgICBuYW1lPSdBcHBsaWNhdGlvbl9sZWZ0X2lkJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkZvcmVpZ25LZXkoZGJfY29sdW1uPSdBcHBsaWNhdGlvbl9sZWZ0X2lkJywgb25fZGVsZXRlPWRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24uQ0FTQ0FERSwgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLmFwcGxpY2F0aW9uJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhcHBsaWNhdGlvbl9leGVjdXRvcnNfbWFueScsCiAgICAgICAgICAgIG5hbWU9J1VzZXJfcmlnaHRfaWQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRm9yZWlnbktleShkYl9jb2x1bW49J1VzZXJfcmlnaHRfaWQnLCBvbl9kZWxldGU9ZGphbmdvLmRiLm1vZGVscy5kZWxldGlvbi5DQVNDQURFLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEudXNlcicpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYXBwbGljYXRpb25fYXNzaWduZWVzX21hbnknLAogICAgICAgICAgICBuYW1lPSdBcHBsaWNhdGlvbl9sZWZ0X2lkJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkZvcmVpZ25LZXkoZGJfY29sdW1uPSdBcHBsaWNhdGlvbl9sZWZ0X2lkJywgb25fZGVsZXRlPWRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24uQ0FTQ0FERSwgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLmFwcGxpY2F0aW9uJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhcHBsaWNhdGlvbl9hc3NpZ25lZXNfbWFueScsCiAgICAgICAgICAgIG5hbWU9J1VzZXJfcmlnaHRfaWQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRm9yZWlnbktleShkYl9jb2x1bW49J1VzZXJfcmlnaHRfaWQnLCBvbl9kZWxldGU9ZGphbmdvLmRiLm1vZGVscy5kZWxldGlvbi5DQVNDQURFLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEudXNlcicpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5EZWxldGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0ndGlja2V0X2V4ZWN1dG9yc19tYW55JywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuRGVsZXRlTW9kZWwoCiAgICAgICAgICAgIG5hbWU9J3RpY2tldF9hc3NpZ25lZXNfbWFueScsCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create model application_assignees_many
--
CREATE TABLE "Application_assignees_many" ("id" serial NOT NULL PRIMARY KEY);
--
-- Create model application_executors_many
--
CREATE TABLE "Application_executors_many" ("id" serial NOT NULL PRIMARY KEY);
--
-- Rename model ticket to application
--
--
-- Rename model ticketclassifier to applicationclassifier
--
--
-- Rename model ticketclassifierhistoryrecord to applicationclassifierhistoryrecord
--
--
-- Rename model tickethistoryrecord to applicationhistoryrecord
--
--
-- Rename model ticketsource to applicationsource
--
--
-- Rename model ticketsourcehistoryrecord to applicationsourcehistoryrecord
--
--
-- Rename model ticketstatus to applicationstatus
--
--
-- Rename model ticketstatushistoryrecord to applicationstatushistoryrecord
--
--
-- Rename table for application to Application
--
ALTER TABLE "Ticket" RENAME TO "Application";
--
-- Rename table for applicationclassifier to ApplicationClassifier
--
ALTER TABLE "TicketClassifier" RENAME TO "ApplicationClassifier";
--
-- Rename table for applicationclassifierhistoryrecord to ApplicationClassifierHistoryRecord
--
ALTER TABLE "TicketClassifierHistoryRecord" RENAME TO "ApplicationClassifierHistoryRecord";
--
-- Rename table for applicationhistoryrecord to ApplicationHistoryRecord
--
ALTER TABLE "TicketHistoryRecord" RENAME TO "ApplicationHistoryRecord";
--
-- Rename table for applicationsource to ApplicationSource
--
ALTER TABLE "TicketSource" RENAME TO "ApplicationSource";
--
-- Rename table for applicationsourcehistoryrecord to ApplicationSourceHistoryRecord
--
ALTER TABLE "TicketSourceHistoryRecord" RENAME TO "ApplicationSourceHistoryRecord";
--
-- Rename table for applicationstatus to ApplicationStatus
--
ALTER TABLE "TicketStatus" RENAME TO "ApplicationStatus";
--
-- Rename table for applicationstatushistoryrecord to ApplicationStatusHistoryRecord
--
ALTER TABLE "TicketStatusHistoryRecord" RENAME TO "ApplicationStatusHistoryRecord";
--
-- Add field Application_left_id to application_executors_many
--
ALTER TABLE "Application_executors_many" ADD COLUMN "Application_left_id" uuid NOT NULL CONSTRAINT "Application_executor_Application_left_id_ae184e78_fk_Applicati" REFERENCES "Application"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Application_executor_Application_left_id_ae184e78_fk_Applicati" IMMEDIATE;
--
-- Add field User_right_id to application_executors_many
--
ALTER TABLE "Application_executors_many" ADD COLUMN "User_right_id" uuid NOT NULL CONSTRAINT "Application_executors_many_User_right_id_2a8d16fb_fk_User_id" REFERENCES "User"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Application_executors_many_User_right_id_2a8d16fb_fk_User_id" IMMEDIATE;
--
-- Add field Application_left_id to application_assignees_many
--
ALTER TABLE "Application_assignees_many" ADD COLUMN "Application_left_id" uuid NOT NULL CONSTRAINT "Application_assignee_Application_left_id_3b44e365_fk_Applicati" REFERENCES "Application"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Application_assignee_Application_left_id_3b44e365_fk_Applicati" IMMEDIATE;
--
-- Add field User_right_id to application_assignees_many
--
ALTER TABLE "Application_assignees_many" ADD COLUMN "User_right_id" uuid NOT NULL CONSTRAINT "Application_assignees_many_User_right_id_7f841872_fk_User_id" REFERENCES "User"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Application_assignees_many_User_right_id_7f841872_fk_User_id" IMMEDIATE;
--
-- Delete model ticket_executors_many
--
DROP TABLE "Ticket_executors_many" CASCADE;
--
-- Delete model ticket_assignees_many
--
DROP TABLE "Ticket_assignees_many" CASCADE;
CREATE INDEX "Application_executors_many_Application_left_id_ae184e78" ON "Application_executors_many" ("Application_left_id");
CREATE INDEX "Application_executors_many_User_right_id_2a8d16fb" ON "Application_executors_many" ("User_right_id");
CREATE INDEX "Application_assignees_many_Application_left_id_3b44e365" ON "Application_assignees_many" ("Application_left_id");
CREATE INDEX "Application_assignees_many_User_right_id_7f841872" ON "Application_assignees_many" ("User_right_id");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Delete model ticket_assignees_many
--
CREATE TABLE "Ticket_assignees_many" ("id" serial NOT NULL PRIMARY KEY, "Ticket_left_id" uuid NOT NULL, "User_right_id" uuid NOT NULL);
--
-- Delete model ticket_executors_many
--
CREATE TABLE "Ticket_executors_many" ("id" serial NOT NULL PRIMARY KEY, "Ticket_left_id" uuid NOT NULL, "User_right_id" uuid NOT NULL);
--
-- Add field User_right_id to application_assignees_many
--
ALTER TABLE "Application_assignees_many" DROP COLUMN "User_right_id" CASCADE;
--
-- Add field Application_left_id to application_assignees_many
--
ALTER TABLE "Application_assignees_many" DROP COLUMN "Application_left_id" CASCADE;
--
-- Add field User_right_id to application_executors_many
--
ALTER TABLE "Application_executors_many" DROP COLUMN "User_right_id" CASCADE;
--
-- Add field Application_left_id to application_executors_many
--
ALTER TABLE "Application_executors_many" DROP COLUMN "Application_left_id" CASCADE;
--
-- Rename table for applicationstatushistoryrecord to ApplicationStatusHistoryRecord
--
ALTER TABLE "ApplicationStatusHistoryRecord" RENAME TO "TicketStatusHistoryRecord";
--
-- Rename table for applicationstatus to ApplicationStatus
--
ALTER TABLE "ApplicationStatus" RENAME TO "TicketStatus";
--
-- Rename table for applicationsourcehistoryrecord to ApplicationSourceHistoryRecord
--
ALTER TABLE "ApplicationSourceHistoryRecord" RENAME TO "TicketSourceHistoryRecord";
--
-- Rename table for applicationsource to ApplicationSource
--
ALTER TABLE "ApplicationSource" RENAME TO "TicketSource";
--
-- Rename table for applicationhistoryrecord to ApplicationHistoryRecord
--
ALTER TABLE "ApplicationHistoryRecord" RENAME TO "TicketHistoryRecord";
--
-- Rename table for applicationclassifierhistoryrecord to ApplicationClassifierHistoryRecord
--
ALTER TABLE "ApplicationClassifierHistoryRecord" RENAME TO "TicketClassifierHistoryRecord";
--
-- Rename table for applicationclassifier to ApplicationClassifier
--
ALTER TABLE "ApplicationClassifier" RENAME TO "TicketClassifier";
--
-- Rename table for application to Application
--
ALTER TABLE "Application" RENAME TO "Ticket";
--
-- Rename model ticketstatushistoryrecord to applicationstatushistoryrecord
--
--
-- Rename model ticketstatus to applicationstatus
--
--
-- Rename model ticketsourcehistoryrecord to applicationsourcehistoryrecord
--
--
-- Rename model ticketsource to applicationsource
--
--
-- Rename model tickethistoryrecord to applicationhistoryrecord
--
--
-- Rename model ticketclassifierhistoryrecord to applicationclassifierhistoryrecord
--
--
-- Rename model ticketclassifier to applicationclassifier
--
--
-- Rename model ticket to application
--
--
-- Create model application_executors_many
--
DROP TABLE "Application_executors_many" CASCADE;
--
-- Create model application_assignees_many
--
DROP TABLE "Application_assignees_many" CASCADE;
ALTER TABLE "Ticket_assignees_many" ADD CONSTRAINT "Ticket_assignees_many_Ticket_left_id_035a86c9_fk_Ticket_id" FOREIGN KEY ("Ticket_left_id") REFERENCES "Ticket" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Ticket_assignees_many" ADD CONSTRAINT "Ticket_assignees_many_User_right_id_48efe9c7_fk_User_id" FOREIGN KEY ("User_right_id") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Ticket_assignees_many_Ticket_left_id_035a86c9" ON "Ticket_assignees_many" ("Ticket_left_id");
CREATE INDEX "Ticket_assignees_many_User_right_id_48efe9c7" ON "Ticket_assignees_many" ("User_right_id");
ALTER TABLE "Ticket_executors_many" ADD CONSTRAINT "Ticket_executors_many_Ticket_left_id_63fa7114_fk_Ticket_id" FOREIGN KEY ("Ticket_left_id") REFERENCES "Ticket" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Ticket_executors_many" ADD CONSTRAINT "Ticket_executors_many_User_right_id_a59be095_fk_User_id" FOREIGN KEY ("User_right_id") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Ticket_executors_many_Ticket_left_id_63fa7114" ON "Ticket_executors_many" ("Ticket_left_id");
CREATE INDEX "Ticket_executors_many_User_right_id_a59be095" ON "Ticket_executors_many" ("User_right_id");
COMMIT;

    `)
}
